(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{0:function(e,t){if(!window.React)throw Error("React must be defined on global variable");e.exports=window.React},201:function(e,t,n){e.exports=n(309)},305:function(e,t,n){},307:function(e,t,n){},309:function(e,t,n){"use strict";n.r(t);var a=n(11),r=n.n(a),i=n(16),o=n(22),s=n(0),l=n.n(s),c=n(77),u=n.n(c),d=n(199),p=n(7),m=n(2),v=n(5),f=n(1),h=n(3),w=n(4),b=n(79),g=n(200),x=n(195),y=n.n(x);b.a.plugin(g.a),b.a.plugin(y.a),window.PouchDB=b.a,window.session_db=new b.a("session"),window.rapyd_config||(window.rapyd_config={}),window.localStorage.rapyd_server_url||(window.rapyd_config.url?window.localStorage.rapyd_server_url=window.rapyd_config.url:"file:"===window.location.protocol?window.localStorage.rapyd_server_url="http://localhost:8069":window.localStorage.rapyd_server_url=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:":8069"));var _={};function k(){var e=document.getElementById("app");if(e){var t=document.createElement("div");t.className="preloader-modal",t.insertAdjacentHTML("beforeend",'\n    <div class="preloader color-white">\n      <span class="preloader-inner">\n        <span class="preloader-inner-gap"></span>\n        <span class="preloader-inner-left">\n          <span class="preloader-inner-half-circle"></span>\n        </span>\n        <span class="preloader-inner-right">\n          <span class="preloader-inner-half-circle"></span>\n        </span>\n      </span>\n    </div>');var n=document.createElement("div");return n.className="preloader-backdrop",e.insertAdjacentElement("beforeend",n),e.insertAdjacentElement("beforeend",t),{done:function(){t.remove(),n.remove()}}}}function E(){return(E=Object(i.a)(r.a.mark(function e(){var t,n,a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window.session_db,!window.models){e.next=3;break}return e.abrupt("return",{models:window.models,tools:window.tools,local_db:window.local_db});case 3:return e.prev=3,e.next=6,t.get("session");case 6:return n=e.sent,e.prev=7,e.next=10,O({login:n.login,password:n.password,encrypted:!0,client_js_time:n.client_js_time});case 10:if(a=e.sent){e.next=17;break}return e.next=14,C();case 14:window.location.reload(),e.next=18;break;case 17:a.client_js||(a.client_js=n.client_js);case 18:n=a,e.next=24;break;case 21:e.prev=21,e.t0=e.catch(7),console.log(e.t0);case 24:return e.next=26,T(n);case 26:return e.abrupt("return",{models:window.models,tools:window.tools,local_db:window.local_db});case 29:return e.prev=29,e.t1=e.catch(3),console.log(e.t1),e.abrupt("return",{});case 33:case"end":return e.stop()}},e,this,[[3,29],[7,21]])}))).apply(this,arguments)}function j(){return(j=Object(i.a)(r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.session_db.get("session");case 2:return n=e.sent,e.next=5,window.session_db.put(Object(o.a)({},n,t));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function O(e){return S.apply(this,arguments)}function S(){return(S=Object(i.a)(r.a.mark(function e(t){var n,a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.encrypted=!!t.encrypted,e.next=3,B("post","json",window.localStorage.rapyd_server_url+"/api/login",t);case 3:if(n=e.sent,console.log(n),"denied"!==n.status){e.next=9;break}return e.abrupt("return",!1);case 9:if("error"!==n.status){e.next=11;break}throw Error("There are an error on the server");case 11:return e.prev=11,e.next=14,window.session_db.get("session");case 14:a=e.sent,n._rev=a._rev,n.unsaved=a.unsaved,n.client_js=n.client_js||a.client_js,n.client_js_time=n.client_js_time||a.client_js_time,e.next=24;break;case 21:e.prev=21,e.t0=e.catch(11),n.unsaved={};case 24:return n._id="session",e.next=27,window.session_db.put(n);case 27:return e.abrupt("return",n);case 28:case"end":return e.stop()}},e,this,[[11,21]])}))).apply(this,arguments)}function C(){return N.apply(this,arguments)}function N(){return(N=Object(i.a)(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,window.session_db.get("session");case 3:return t=e.sent,e.next=6,window.session_db.remove(t);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:return window.local_db.destroy(),e.abrupt("return",window.location.reload());case 13:case"end":return e.stop()}},e,this,[[0,8]])}))).apply(this,arguments)}function L(e){return new Promise(function(t,n){var a=setInterval(function(){e()&&(clearInterval(a),t())},0)})}function T(e){return D.apply(this,arguments)}function D(){return(D=Object(i.a)(r.a.mark(function e(t){var n,a,i,o,s,l;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=document.createElement("script"),a=window.URL||window.webkitURL;try{i=new Blob([t.client_js])}catch(r){o=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder,(i=o()).append(t.client_js),i=i.getBlob()}return n.type="text/javascript",n.src=a.createObjectURL(i),document.body.appendChild(n),e.next=8,L(function(){return window.models});case 8:(s=window.tools).configuration=Object.assign(s.configuration,window.rapyd_config),s.configuration.url=window.localStorage.rapyd_server_url,(l=window.models).env.context.unsaved=t.unsaved||{},l.env.user=l.env["res.users"].browse(),l.env.user.id=t.id,l.env.user.login=t.login,l.env.user.password=t.password,s.configuration.ajax_load=function(e){e.no_preload||(e.preload=k())},s.configuration.ajax_resolve=function(e,t,n){n.no_preload||n.preload.done(),e(t.response)},s.configuration.ajax_reject=function(e,t,n){n.no_preload||n.preload.done(),e(t)},_.exceptionCount=0,s.configuration.exception=function(e){throw _.app.dialog.alert("There are some error"),_.exceptionCount+=1,e},_.warningCount=0,s.configuration.warning=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(0!==_.warningCount)return new Promise(function(t){_.warningCount=0,t(!0),console.warn(e)});console.log(_),t&&_.app.toast.create({text:"You are offline, using local data",closeButton:!0,closeTimeout:1e3}).open(),_.warningCount+=1,console.warn(e)};case 24:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function B(e,t,n,a){return void 0!==a&&(a=I(a)),new Promise(function(r,i){var o=new XMLHttpRequest;o.open(e,n,!0),o.onload=function(){r(this.response)},o.onerror=function(){i(this.statusText)},void 0===t&&(t="json"),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.responseType=t;try{o.send(a)}catch(s){i(s)}})}function I(e){var t=[];for(var n in e){var a=e[n];"object"===typeof a?a=JSON.stringify(a):""===a&&(a=null),t.push(encodeURIComponent(n)+"="+encodeURIComponent(a))}return t.join("&")}var P={globals:_,preload:k,get_session:function(){return E.apply(this,arguments)},update_session:function(e){return j.apply(this,arguments)},wait:function(e){return new Promise(function(t,n){var a=setTimeout(function(){return clearInterval(a),void t()},e)})},wait_exist:L,login:O,logout:C,ORM:T,ajax:B,parseURI:I,hasValue:function(e,t){return void 0!==e&&null!==e&&!1!==e&&([Array,String].indexOf(e.constructor)<0&&(e=e.toString()),e.indexOf(t)>-1)},hasKey:function(e,t){return void 0!==e&&null!==e&&!1!==e&&Object.keys(e).indexOf(t)>-1}},F=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(f.a)(this,Object(h.a)(t).call(this,e))).state={username:"",password:""},n}return Object(w.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){var e=!0,t=!1,n=void 0;try{for(var a,r=document.querySelectorAll("input[type=text], input[type=password]")[Symbol.iterator]();!(e=(a=r.next()).done);e=!0){a.value.addEventListener("keyup",this.clickEvent.bind(this))}}catch(i){t=!0,n=i}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}}},{key:"render",value:function(){var e=this;return l.a.createElement(p.Page,{noToolbar:!0,noNavbar:!0,noSwipeback:!0,loginScreen:!0},l.a.createElement(p.LoginScreenTitle,null,"Welcome"),l.a.createElement(p.List,{form:!0},l.a.createElement(p.ListInput,{label:"Username",type:"text",placeholder:"Your username",value:this.state.username,onInput:function(t){e.setState({username:t.target.value})},autofocus:!0}),l.a.createElement(p.ListInput,{label:"Password",type:"password",placeholder:"Your password",value:this.state.password,onInput:function(t){e.setState({password:t.target.value})}}),l.a.createElement(p.Button,{onClick:this.signIn.bind(this),style:{float:"left",marginLeft:"10px"}},"Login"),l.a.createElement(p.Button,{onClick:this.setUrl.bind(this),style:{float:"right",marginRight:"10px"}},"Settings")))}},{key:"clickEvent",value:function(e){e.preventDefault(),13===e.keyCode&&this.signIn()}},{key:"setUrl",value:function(){this.$f7.dialog.prompt("","Server URL",function(e){return localStorage.rapyd_server_url=e});var e=document.querySelector("input.dialog-input");e&&(e.value=localStorage.rapyd_server_url)}},{key:"signIn",value:function(){var e=Object(i.a)(r.a.mark(function e(){var t,n,a,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=P.preload(),a=(n=this).$f7,e.prev=3,e.next=6,P.login({login:n.state.username,password:n.state.password,encrypted:!1});case 6:if(i=e.sent,t.done(),i){e.next=10;break}return e.abrupt("return",a.dialog.alert("Username/Password wrong, relogin"));case 10:a.dialog.alert("Login Successful!",function(){window.location.reload()}),e.next=18;break;case 13:throw e.prev=13,e.t0=e.catch(3),t.done(),a.dialog.alert("Network Error"),e.t0;case 18:case"end":return e.stop()}},e,this,[[3,13]])}));return function(){return e.apply(this,arguments)}}()}]),t}(l.a.Component),R=n(21),M=n(6),V=function(e){return l.a.createElement(p.Page,null,l.a.createElement(p.Navbar,{backLinkForce:!e.cache||!JSON.parse(e.cache),backLink:"/"!==window.models.env.context.active_url&&"Back"},"/"===window.models.env.context.active_url&&l.a.createElement(p.NavLeft,null,l.a.createElement(p.Link,{iconMd:"material:menu",panelOpen:"left"})),l.a.createElement(p.NavTitle,null,e.title),l.a.createElement(p.NavRight,null,l.a.createElement(p.Link,{iconMd:"material:person",panelOpen:"right"}))),e.children)},q=n(196),A=(n(243),n(245),function(e){function t(){return Object(m.a)(this,t),Object(f.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(w.a)(t,e),Object(v.a)(t,[{key:"render",value:function(e){return l.a.createElement("div",{style:{height:"100%"},className:"ag-theme-material"},l.a.createElement(q.AgGridReact,{rowSelection:"multiple",paginationPageSize:e.paginationPageSize,pagination:!0,enableColResize:!0,enableServerSideSorting:!0,enableServerSideFilter:!0,suppressMultiSort:!0,suppressRowClickSelection:!0,onGridReady:e.onGridReady,onRowClicked:e.onRowClicked,onSelectionChanged:e.onSelectionChanged,onPaginationChanged:e.onPaginationChanged,onSortChanged:e.onSortChanged,onFilterChanged:e.onFilterChanged,columnDefs:e.columnDefs,rowData:e.rowData,frameworkComponents:e.frameworkComponents}))}}]),t}(l.a.Component)),U=n(48),H=(n(299),n(197)),G=n.n(H),z=(n(301),function(e){function t(){return Object(m.a)(this,t),Object(f.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(w.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){var e=this;console.log(this.props.customInput);var t=this.props.customInput||(this.props.inline?this.refs.flatpickr.cloneNode(!1):this.refs.flatpickr);if(t){this.props.inline&&(t.style.display="",this.refs.flatpickr.insertAdjacentElement("afterend",t));var n=this.props.onChange;this.props.readOnly&&(n=function(t){return t!==e.props.defaultDate&&(e.props.defaultDate?e.flatpickr.setDate(e.props.defaultDate):e.flatpickr.clear())}),this.flatpickr=G()(t,Object(o.a)({},this.props,{onChange:function(){var t=Object(i.a)(r.a.mark(function t(a){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n(a);case 2:e.flatpickr.open();case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}))}}},{key:"componentDidUpdate",value:function(){var e=this;if(this.props.customInput&&this.componentDidMount(),this.flatpickr){var t=this.props.onChange;this.props.readOnly&&(t=function(t){return t!==e.props.defaultDate&&(e.props.defaultDate?e.flatpickr.setDate(e.props.defaultDate):e.flatpickr.clear())}),this.flatpickr.set("onChange",function(){var n=Object(i.a)(r.a.mark(function n(a){return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t(a);case 2:e.flatpickr.open();case 3:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}()),this.flatpickr.setDate(this.props.defaultDate)}}},{key:"render",value:function(e){return e.customComponent||l.a.createElement("input",{ref:"flatpickr",style:e.inline&&{display:"none"}})}}]),t}(l.a.Component)),W=U.Templates.singleSelectInput;U.Templates.singleSelectInput=function(e){return W(e).replace('<i class="fa fa-sort-desc selectivity-caret"></i>','<i class="selectivity-caret material-icons">expand_more</i>')};var J=U.Templates.singleSelectedItem;U.Templates.singleSelectedItem=function(e){return J(e).replace('<i class="fa fa-remove"></i>','<i class="selectivity-remove material-icons">close</i>')};var $=U.Templates.multipleSelectedItem;U.Templates.multipleSelectedItem=function(e){return $(e).replace('<i class="fa fa-remove"></i>','<i class="selectivity-remove selectivity-multi-remove material-icons">close</i>')};var Y=function(e){function t(){return Object(m.a)(this,t),Object(f.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(w.a)(t,e),Object(v.a)(t,[{key:"setValue",value:function(){var e=Object(i.a)(r.a.mark(function e(t,n){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.models.env.context.active_error&&(window.models.env.context.active_error.field_map[this.props.name]=!1),this.props.cellEdit||(window.models.env.context.active_id[this.props.name]=t),e.next=4,this.setState({value:n||t});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(i.a)(r.a.mark(function e(){var t,n,a,i,o,s,l,c;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.wait_exist(function(){return window.models.env.context.active_id});case 2:if(t=this.props,n=window.models,a=t.model||window.models.env.context.active_model,i=window.models.env[a]._fields[t.name],o=i.type,!((s=window.models.env.context).active_id._pending_promises.length>0)){e.next=11;break}return e.next=11,s.active_id._wait_promise();case 11:if(l=t.cellEdit?null:s.active_id&&s.active_id[this.props.name],this.props.ref_object&&Object.assign(this.props.ref_object,this.refs,{loaded:!0}),!this.refs.input){e.next=17;break}P.hasValue(["text","data"],o)?this.refs.input.$listEl[0].querySelector("textarea").value="data"!==o?l:JSON.stringify(l):this.refs.input.$listEl[0].querySelector("input").value=l,e.next=42;break;case 17:if(!P.hasValue(["many2many","one2many","many2one","one2one"],o)||t.children){e.next=31;break}if(l){e.next=20;break}return e.abrupt("return",this.setState({value:void 0}));case 20:return e.next=22,n.env[i.relation].browse(l);case 22:if(c=e.sent,l.constructor!==String){e.next=27;break}return e.abrupt("return",this.setState({value:{id:c.id,text:c[c._rec_name||"name"]}}));case 27:if(l.constructor!==Array){e.next=29;break}return e.abrupt("return",this.setState({value:Array.from(c.__iter__()).map(function(e){return{id:e.id,text:e[e._rec_name||"name"]}})}));case 29:e.next=42;break;case 31:if("selection"!==o){e.next=37;break}if("statusbar"!==this.props.widget){e.next=34;break}return e.abrupt("return",this.setState({value:l}));case 34:return e.abrupt("return",this.setState({value:l&&{id:l,text:window.tools.dict(i.selection)[l]}}));case 37:if(!P.hasValue(["date","datetime"],o)){e.next=41;break}return e.abrupt("return",this.setState({value:l,input:this.refs.date_input.$listEl[0].querySelector("input")}));case 41:return e.abrupt("return",this.setState({value:l}));case 42:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.refs.selectivity&&this.refs.selectivity.selectivity&&this.refs.selectivity.selectivity.destroy()}},{key:"render",value:function(e){var t=this,n=window.models,a=e.model||window.models.env.context.active_model,o=window.models.env[a]._fields[e.name];if(o){var s,c=e.string||o.string,u=o.type,d=window.models.env.context;this.refs;if(P.hasValue(["many2many","one2many"],u)&&e.children)return e.children;if("selection"===u&&"statusbar"===e.widget){var m=!0,v=window.tools.copy(o.selection).reverse();return s=l.a.createElement("div",null,v.map(function(t){return m?l.a.createElement(p.F7Button,{raised:n.env.context.active_id&&n.env.context.active_id[e.name]===t[0],className:"rapyd-statusbars"},(m=!1)||t[1]):[l.a.createElement("span",{className:"rapyd-statusbars rapyd-statusbar-arrow"},">"),l.a.createElement(p.F7Button,{raised:n.env.context.active_id&&n.env.context.active_id[e.name]===t[0],className:"rapyd-statusbars"},t[1])]}))}if(P.hasValue(["many2many","one2many","many2one","one2one","selection"],u)){var f,h=null;if(P.hasValue(["many2many","one2many","many2one","one2one"],u)?f={url:window.tools.configuration.url,minimumInputLength:0,params:function(){return{}},placeholder:"",fetch:function(e,t,n){return b.apply(this,arguments)}}:"selection"===u&&(h=o.selection.map(function(e){return{id:e[0],text:e[1]}})),s=l.a.createElement(p.ListInput,{label:c,input:!1,errorMessageForce:!!window.models.env.context.active_error&&window.models.env.context.active_error.field_map[e.name],errorMessage:"Field required"},l.a.createElement(U.React,{ref:"selectivity",slot:"input",ajax:f,items:h,placeholder:e.placeholder||"",readOnly:!d.editing,multiple:P.hasValue(["many2many","one2many"],u),data:this.state.value,onChange:function(e){return t.setValue(e.value,e.data)},onDropdownClose:e.onSelect,allowClear:!0,closeOnSelect:!0})),e.cellEdit)return s.children[0]}else if(P.hasValue(["date","datetime"],u)){var w=l.a.createElement("ul",null,l.a.createElement(p.ListInput,{ref:"date_input",label:c,placeholder:e.placeholder||"",disabled:!d.editing,errorMessageForce:!!window.models.env.context.active_error&&window.models.env.context.active_error.field_map[e.name],errorMessage:"Field required"}));if(s=l.a.createElement(z,{customComponent:w,customInput:this.state.input,enableTime:"datetime"===u&&!0,enableSeconds:"datetime"===u&&!0,defaultDate:this.state.value,onChange:function(e){return t.setValue(e)}}),e.cellEdit)return s.children.children}else s=l.a.createElement(p.ListInput,{ref:"input",label:c,type:{char:"text",text:"textarea",float:"number",integer:"number",data:"textarea"}[u],placeholder:e.placeholder||"",disabled:!d.editing,onChange:function(e){return t.setValue(e.target.value)},errorMessageForce:!!window.models.env.context.active_error&&window.models.env.context.active_error.field_map[e.name],errorMessage:"Field required"});return l.a.createElement(p.List,null,s)}function b(){return(b=Object(i.a)(r.a.mark(function e(t,i,s){var l,c,d,p,m,v,f,h,w,b,g;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,l=10,n.env.context.active_limit=l,n.env.context.active_index=s.offset/l,e.next=6,n.env[o.relation].with_context({no_preload:!0}).search([n.env[o.relation]._rec_name||"name","ilike",s.term]);case 6:if(c=e.sent,n.env.context.active_lines[o.relation])for(d in n.env.context.active_lines[a])c.add(n.env.context.active_lines[o.relation][d].filter(function(e){return e[e._rec_name||"name"]&&-1!==e[e._rec_name||"name"].toLowerCase().indexOf(s.term.toLowerCase())}));if(p=[],"selection"!==u){e.next=11;break}return e.abrupt("return",{results:p,more:!1});case 11:m=!0,v=!1,f=void 0,e.prev=14,h=c[Symbol.iterator]();case 16:if(m=(w=h.next()).done){e.next=28;break}if((b=w.value).id){e.next=24;break}return g="etemp"+Math.random().toString(36).substr(2,9),P.globals.temp_records||(P.globals.temp_records={}),P.globals.temp_records[g]=b,p.push({id:g,text:b[b._rec_name||"name"]}),e.abrupt("continue",25);case 24:p.push({id:b.id,text:b[b._rec_name||"name"]});case 25:m=!0,e.next=16;break;case 28:e.next=34;break;case 30:e.prev=30,e.t0=e.catch(14),v=!0,f=e.t0;case 34:e.prev=34,e.prev=35,m||null==h.return||h.return();case 37:if(e.prev=37,!v){e.next=40;break}throw f;case 40:return e.finish(37);case 41:return e.finish(34);case 42:return n.env.context.active_index=0,console.log((s.offset/l+1)*l<c._search_count),console.log(p),e.abrupt("return",{results:p,more:(s.offset/l+1)*l<c._search_count});case 48:throw e.prev=48,e.t1=e.catch(0),console.error(e.t1),e.t1;case 52:case"end":return e.stop()}},e,this,[[0,48],[14,30,34,42],[35,,37,41]])}))).apply(this,arguments)}}}]),t}(l.a.Component),K=function(e){function t(){return Object(m.a)(this,t),Object(f.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(w.a)(t,e),Object(v.a)(t,[{key:"afterGuiAttached",value:function(){var e=Object(i.a)(r.a.mark(function e(){var t=this;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.wait_exist(function(){return t.refs.loaded});case 2:this.refs.selectivity&&this.refs.selectivity.selectivity&&this.refs.selectivity.selectivity.open();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getValue",value:function(){if(this.refs.selectivity&&this.refs.selectivity.selectivity){var e=this.refs.selectivity.selectivity.getData();if(!e)return e;var t=window.tools.copy(this.props.column.colDef);delete t.cellEditorFramework;var n=this.refs.selectivity.selectivity.getValue();Array.isArray(n)||(n=[n]);var a=window.models.env[window.models.env[this.props.model]._fields[this.props.name].relation],r=!0,i=!1,o=void 0;try{for(var s,l=n[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var c=s.value;if("etemp"===c.slice(0,5))a.add(P.globals.temp_records[c]);else{var u=a.browse();u.update({id:c}),a.add(u)}}}catch(d){i=!0,o=d}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return console.log(a),this.props.tree.onChange({colDef:t,data:this.props.tree.state.records[this.props.rowIndex],oldValue:null,newValue:a}),Array.isArray(e)?e.map(function(e){return e.text}).join(", "):e.text}}},{key:"onSelect",value:function(){var e=Object(i.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.wait(10);case 2:this.props.api.stopEditing();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(e){this.refs={};var t=this.onSelect.bind(this);return l.a.createElement(Y,Object.assign({},e,{ref_object:this.refs,cellEdit:!0,onSelect:t}))}}]),t}(s.Component);var X=function(e){function t(e){var n;Object(m.a)(this,t),n=Object(f.a)(this,Object(h.a)(t).call(this,e));var a=e.model||window.models.env.context.active_model;function s(){return!(e.isTreeView&&!e.editable)&&!!window.models.env.context.editing}n.isEditable=s,n.pendingTask={create:!1,write:!1,tasked:!1},n.pendingCreate=!1,n.pendingWrite=!1,n.onChange=function(e){var t=this;if(!e.colDef.cellEditorFramework&&e.newValue!=e.oldValue){var n=e.newValue,a=e.data.id?window.models.env.context.active_lines[this.state.model][this.state.tree_field].find(e.data.id):this.state.new_records.values===e.data._original_object_for_id&&this.state.new_records||Array.from(this.state.new_records.__iter__()).find(function(t){return t.values===e.data._original_object_for_id});!this.pendingTask.write&&a.id?this.pendingTask.write=!0:this.pendingTask.write||a.id||(this.pendingTask.create=!0),this.pendingTask.tasked||!this.pendingTask.create&&!this.pendingTask.write||(this.pendingTask.tasked=!0,window.models.env.context.active_task.push(Object(i.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.pendingTask.create){e.next=3;break}return e.next=3,t.state.new_records.create();case 3:if(!t.pendingTask.write){e.next=6;break}return e.next=6,window.models.env.context.active_lines[t.state.model][t.state.tree_field].write();case 6:case"end":return e.stop()}},e,this)})).bind(this))),a[e.colDef.field]=n}}.bind(Object(M.a)(Object(M.a)(n))),n.onSelectionChanged=function(e){var t=e.api.getSelectedRows(),n=[],a=!0,r=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var l=o.value;l.id&&n.push(l.id)}}catch(c){r=!0,i=c}finally{try{a||null==s.return||s.return()}finally{if(r)throw i}}return this.setState({active_ids:n,selected:t})}.bind(Object(M.a)(Object(M.a)(n))),n.handleOutside=function(e){this.refs.grid&&!this.refs.grid.base.contains(e.target)&&this.gridOptions&&this.gridOptions.api.stopEditing()}.bind(Object(M.a)(Object(M.a)(n)));var l=(e.children.constructor===Array?e.children:[e.children]).map(function(e,t){return Object(o.a)({headerName:e.attributes.string||window.models.env[a]._fields[e.attributes.name].string,field:e.attributes.name,filterParams:{applyButton:!0,clearButton:!0},editable:s,onCellValueChanged:n.onChange},-1!==["date","datetime"].indexOf(window.models.env[a]._fields[e.attributes.name].type)||window.models.env[a]._fields[e.attributes.name].relation?{cellEditorFramework:K,cellEditorParams:Object(o.a)({},e.props,{model:a,tree:Object(M.a)(Object(M.a)(n))}),cellClass:"editable-special-cell"}:{})});l[0].checkboxSelection=!0,l[0].headerCheckboxSelection=!0;return n.state={fields:l,records:[],new_records:window.models.env[a],updated_records:{},limit:50,model:a,frameworkComponents:{specialEditor:K},selected:[]},e.field&&(n.state.tree_field=e.field),n}return Object(w.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.handleOutside)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleOutside)}},{key:"paginate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e.length<1)return e;var n=e[0]._search_count;if(t>0)for(var a=0;a<this.state.limit*t;)e.unshift({}),a+=1;for(;e.length<n;)e.push({});return e}},{key:"sort",value:function(e,t){var n=window.models;e.length>0?n.env.context.active_sort=e[0].colId+" "+e[0].sort:delete n.env.context.active_sort,0!==t.api.paginationGetCurrentPage()?t.api.paginationGoToFirstPage():(t.newData=!1,this.paging.bind(this)(0,t))}},{key:"filter",value:function(e,t){var n=window.models,a=this.state.tree_field?[[this.state.tree_field,"in",window.models.env.context.active_ids]]:[],r=[];for(var i in e){var o=[e[i]],s="AND";void 0!==e[i].operator&&(o=[e[i].condition1,e[i].condition2],s=e[i].operator);var l={startsWith:"ilike",endsWith:"ilike",contains:"ilike",notContains:"not ilike",equals:"=",notEqual:"!="};"OR"===s&&a.push("|");for(var c=0;c<o.length;c++){var u=o[c];a.push([i,l[u.type],u.filter]),r.push(u.filter)}}n.env.context.active_args=a;var d=0,p=!0,m=!1,v=void 0;try{for(var f,h=function(){var e=f.value;if(void 0!==r[d]){var t=r[d];setTimeout(function(){return e.value=t},1e3)}d+=1},w=window.document.getElementsByClassName("ag-filter-filter")[Symbol.iterator]();!(p=(f=w.next()).done);p=!0)h()}catch(b){m=!0,v=b}finally{try{p||null==w.return||w.return()}finally{if(m)throw v}}0!==t.api.paginationGetCurrentPage()?t.api.paginationGoToFirstPage():(t.newData=!1,this.paging.bind(this)(0,t))}},{key:"paging",value:function(){var e=Object(i.a)(r.a.mark(function e(t,n){var a,i,o,s,l;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!1===n.newData){e.next=2;break}return e.abrupt("return");case 2:return a=P.preload(),e.prev=3,o=window.models,s=o.env.context.active_args||(this.state.tree_field?[[this.state.tree_field,"in",window.models.env.context.active_ids||[]]]:[]),o.env.context.active_limit=this.state.limit,o.env.context.active_index=t,e.next=10,(i=o.env[this.state.model]).search.apply(i,Object(R.a)(s));case 10:if(l=e.sent,this.props.isTreeView?l.add(this.state.new_records):(o.env.context.active_lines||(o.env.context.active_lines={}),o.env.context.active_lines[this.state.model]||(o.env.context.active_lines[this.state.model]={}),o.env.context.active_lines[this.state.model][this.state.tree_field]?l=o.env.context.active_lines[this.state.model][this.state.tree_field].add(l):o.env.context.active_lines[this.state.model][this.state.tree_field]=l),!(l.length>0)){e.next=26;break}return window.c=this,e.t0=this,e.t1=this,e.next=18,l.read(!0);case 18:return e.t2=e.sent,e.t3=t,e.t4=e.t1.paginate.call(e.t1,e.t2,e.t3),e.t5={records:e.t4},e.next=24,e.t0.setState.call(e.t0,e.t5);case 24:e.next=29;break;case 26:if(0!==l.length){e.next=29;break}return e.next=29,this.setState({records:[]});case 29:e.next=34;break;case 31:e.prev=31,e.t6=e.catch(3),console.log(e.t6);case 34:a.done();case 35:case"end":return e.stop()}},e,this,[[3,31]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"addItem",value:function(){var e=Object(i.a)(r.a.mark(function e(){var t,n,a=this;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isEditable()){e.next=2;break}return e.abrupt("return");case 2:if(t=window.models.env[this.state.model].browse(),window.models.env.context.active_id.id&&(t[this.state.tree_field]=window.models.env.context.active_id.id),!(t._pending_promises.length>0)){e.next=8;break}return e.next=7,t._wait_promise();case 7:this.pendingTask.tasked||(this.pendingTask.create=!0,this.pendingTask.tasked=!0,window.models.env.context.active_task.push(Object(i.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.pendingTask.create){e.next=3;break}return e.next=3,a.state.new_records.create();case 3:if(!a.pendingTask.write){e.next=6;break}return e.next=6,window.models.env.context.active_lines[a.state.model][a.state.tree_field].write();case 6:case"end":return e.stop()}},e,this)})).bind(this)));case 8:return e.next=10,t.read(!0);case 10:return n=e.sent,this.state.new_records.add(t),this.state.records.push(n[0]),this.props.treeView||window.models.env.context.active_lines[this.state.model][this.state.tree_field].add(t),e.next=16,this.setState({records:this.state.records,new_records:this.state.new_records});case 16:this.gridOptions.api.updateRowData({add:n});case 17:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"removeItem",value:function(){var e=Object(i.a)(r.a.mark(function e(){var t,n,a,i,o,s,l,c,u,d,p;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.isTreeView){e.next=9;break}return e.next=3,window.models.env[this.state.model].browse(this.state.active_ids);case 3:return t=e.sent,e.next=6,t.unlink();case 6:return e.next=8,this.paging.bind(this)(0,{newData:!1});case 8:return e.abrupt("return",this.setState({selected:[]}));case 9:n=!0,a=!1,i=void 0,e.prev=12,o=this.state.selected[Symbol.iterator]();case 14:if(n=(s=o.next()).done){e.next=32;break}for(c in l=s.value,this.state.records)l===this.state.records[c]&&this.state.records.pop(c);if(window.models.env.context.active_id.id){e.next=24;break}if(u=window.models.env.context.active_lines[this.state.model][this.state.tree_field].values,Array.isArray(u)){e.next=22;break}return l._original_object_for_id===u&&(window.models.env.context.active_lines[this.state.model][this.state.tree_field]=window.models.env[this.state.model]),e.abrupt("continue",29);case 22:for(d in u.as_array())l._original_object_for_id===u[d]&&u.pop(d);return e.abrupt("continue",29);case 24:(p={data:l}).oldValue="",p.newValue=null,p.colDef={field:this.state.tree_field},this.onChange(p);case 29:n=!0,e.next=14;break;case 32:e.next=38;break;case 34:e.prev=34,e.t0=e.catch(12),a=!0,i=e.t0;case 38:e.prev=38,e.prev=39,n||null==o.return||o.return();case 41:if(e.prev=41,!a){e.next=44;break}throw i;case 44:return e.finish(41);case 45:return e.finish(38);case 46:return e.next=48,this.setState({records:this.state.records,selected:[]});case 48:this.gridOptions.api.updateRowData({remove:this.state.selected});case 49:case"end":return e.stop()}},e,this,[[12,34,38,46],[39,,41,45]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(e){var t=this,n=e.model||window.models.env.context.active_model,a=window.models,r=l.a.createElement("div",{className:"card-body",style:{height:48*this.state.records.length+112+(this.isEditable()?30:0)<=440?48*this.state.records.length+112+(this.isEditable()?30:0)+"px":"67vh"}},l.a.createElement(A,{ref:"grid",onGridReady:function(e){return(window.onresize=function(){return function(e){this.gridOptions=e;var t=e.api,n=(t.gridPanel.getWidthForSizeColsToFit(),t.gridPanel.columnController.getAllDisplayedColumns());t.gridPanel.columnController.getWidthOfColsInList(n),t.sizeColumnsToFit()}.bind(t)(e)})()}.bind(this),onRowClicked:function(e){return a.env[n].browse(e.data.id).then(function(e){return a.env.context.active_id=e}).then(function(){return P.globals.app.views.main.router.navigate("/form/"+n+"?id="+e.data.id)})},onPaginationChanged:function(e){return t.paging.bind(t)(e.api.paginationGetCurrentPage(),e)},onSortChanged:function(e){return t.sort.bind(t)(e.api.getSortModel(),e)},onFilterChanged:function(e){return t.filter.bind(t)(e.api.getFilterModel(),e)},onSelectionChanged:this.onSelectionChanged,paginationPageSize:this.state.limit,columnDefs:this.state.fields,rowData:this.state.records,frameworkComponents:this.state.frameworkComponents}),l.a.createElement(p.Button,{onClick:this.addItem.bind(this),style:{display:this.isEditable()?"inline-block":"none",top:"-45px"}},"Add"),l.a.createElement(p.Button,{onClick:this.removeItem.bind(this),style:{display:(e.isTreeView||this.isEditable())&&this.state.selected.length>0?"inline-block":"none",top:"-45px"}},"Delete"));return e.isTreeView?l.a.createElement(V,{pageCache:e.pageCache,title:window.tools.view[n].string},l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-header"},l.a.createElement("div",{className:"data-table-title"},window.tools.view[n].string,l.a.createElement("br",null),l.a.createElement(p.Button,{onClick:function(){return P.globals.app.views.main.router.navigate("/form/"+n)},style:{display:"inline-block"},fill:!0},"Create"))),r)):(delete r.props.children[0].props.onRowClicked,r)}}]),t}(l.a.Component),Q={Tree:X,Field:Y};var Z={},ee=function(e){console.log(e);var t=window.models.env.context.active_model;e.f7route?(t=e.f7route.params.model,window.models.env.context.active_url=e.f7route.url):window.models.env.context.active_url="/";var n=window.tools.view[t].tree;return window.models.env.context.active_model=t,Z[n]||(Z[n]=function(e,t){return function e(n){var a=[],r=!0,i=!1,o=void 0;try{for(var s,c=n[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var u=s.value,d=Q[u.tagName[0].toUpperCase()+u.tagName.toLowerCase().slice(1)]||Q[u.tagName]||u.tagName,p={model:t},m=!0,v=!1,f=void 0;try{for(var h,w=u.attributes[Symbol.iterator]();!(m=(h=w.next()).done);m=!0){var b=h.value;p[b.name]=b.value}}catch(g){v=!0,f=g}finally{try{m||null==w.return||w.return()}finally{if(v)throw f}}p.isTreeView=!0,a.push(l.a.createElement(d,p,e(u.children)))}}catch(g){i=!0,o=g}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return a=1===a.length?a[0]:a}([e=(new DOMParser).parseFromString(e,"text/xml").children[0]])}(n,t)),Z[n]},te=n(13),ne=function(e){function t(e){var n;Object(m.a)(this,t),n=Object(f.a)(this,Object(h.a)(t).call(this,e));var a=window.models;return a.env.context.editing=!1,n.state=a.env.context,n}return Object(w.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){var e=Object(i.a)(r.a.mark(function e(t){var n,a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.models.env.context.active_model,(a=window.models).env.context.active_lines={},a.env.context.active_task=[],this,a.env.context.active_ids&&!(a.env.context.active_ids.length<1)&&a.env.context.active_ids[0]){e.next=11;break}return a.env.context.active_id=a.env[n].browse(),a.env.context.editing=!0,e.abrupt("return",this.setState(a.env.context));case 11:if(a.env.context.active_id){e.next=15;break}return e.next=14,a.env[n].browse(a.env.context.active_ids);case 14:a.env.context.active_id=e.sent;case 15:return e.abrupt("return",a.env.context.refresh());case 16:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"edit",value:function(){var e=Object(i.a)(r.a.mark(function e(){var t,n,a,i,s,l,c,u,d,p,m,v,f,h,w,b,g,x,y,_;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window.models,n=t.env.context.active_id._name,a=!!this.props.offline&&JSON.parse(this.props.offline),this.state.editing){e.next=8;break}return t.env.context.editing=!0,e.next=7,this.setState(Object(o.a)({},t.env.context,{offline:a}));case 7:return e.abrupt("return",e.sent);case 8:return i=t.env.context.active_id.id?"write":"create",e.prev=9,e.next=12,t.env.context.active_id[i]({},!a);case 12:e.next=45;break;case 14:if(e.prev=14,e.t0=e.catch(9),!e.t0||e.t0.constructor!==window.tools.exceptions.RequiredError){e.next=44;break}for(e.t0.field_map={},s=!0,l=!1,c=void 0,e.prev=21,u=e.t0.fields[Symbol.iterator]();!(s=(d=u.next()).done);s=!0)p=d.value,e.t0.field_map[p]=!0;e.next=29;break;case 25:e.prev=25,e.t1=e.catch(21),l=!0,c=e.t1;case 29:e.prev=29,e.prev=30,s||null==u.return||u.return();case 32:if(e.prev=32,!l){e.next=35;break}throw c;case 35:return e.finish(32);case 36:return e.finish(29);case 37:return t.env.context.active_error=e.t0,e.next=40,this.setState({active_id:t.env.context.active_id});case 40:return P.globals.app.toast.create({text:"Some fields are required",closeButton:!1,closeTimeout:2e3,position:"center"}).open(),e.abrupt("return");case 44:throw e.t0;case 45:m=!0,v=!1,f=void 0,e.prev=48,h=t.env.context.active_task[Symbol.iterator]();case 50:if(m=(w=h.next()).done){e.next=59;break}if(b=w.value,!(g=b())||g.constructor!==Promise){e.next=56;break}return e.next=56,g;case 56:m=!0,e.next=50;break;case 59:e.next=65;break;case 61:e.prev=61,e.t2=e.catch(48),v=!0,f=e.t2;case 65:e.prev=65,e.prev=66,m||null==h.return||h.return();case 68:if(e.prev=68,!v){e.next=71;break}throw f;case 71:return e.finish(68);case 72:return e.finish(65);case 73:if(t.env.context.active_task=[],"create"!==i){e.next=80;break}for(y in window.history.replaceState(void 0,void 0,window.location.hash+"?id="+t.env.context.active_id.id),x=[],t.env.context.active_lines)for(_ in t.env.context.active_lines[y])x.push(t.env.context.active_lines[y][_].write(Object(te.a)({},_,t.env.context.active_id.id)));return e.next=80,Promise.all(x);case 80:return t.env.context.editing=!1,a&&(t.env.context.unsaved=Object(o.a)({},t.env.context.unsaved,Object(te.a)({},n,Object(o.a)({},t.env.context.unsaved&&t.env.context.unsaved[n],Object(te.a)({},t.env.context.active_id.id,t.env.context.active_id.id))))),e.next=84,P.update_session({unsaved:t.env.context.unsaved});case 84:return e.next=86,this.setState(Object(o.a)({},t.env.context,{offline:a}));case 86:return e.abrupt("return",e.sent);case 87:case"end":return e.stop()}},e,this,[[9,14],[21,25,29,37],[30,,32,36],[48,61,65,73],[66,,68,72]])}));return function(){return e.apply(this,arguments)}}()},{key:"upload",value:function(){var e=Object(i.a)(r.a.mark(function e(){var t,n,a,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.models,n=t.env.context.active_id._name,e.next=4,t.env[n].browse(t.env.context.active_id.id);case 4:if(!((a=e.sent).length<1)){e.next=15;break}return i=a,e.next=9,a.create();case 9:return a=e.sent,e.next=12,i.unlink(!1);case 12:t.env.context.active_id=a,e.next=19;break;case 15:return e.next=17,t.env.context.active_id.write();case 17:a=e.sent,t.env.context.active_id=a;case 19:return t.env.context.unsaved&&t.env.context.unsaved[n]&&t.env.context.unsaved[n][a.id]&&delete t.env.context.unsaved[n][a.id],e.next=22,P.update_session({unsaved:t.env.context.unsaved});case 22:return e.next=24,this.setState(Object(o.a)({},t.env.context,{offline:!1}));case 24:return e.abrupt("return",e.sent);case 25:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(e){var t=window.models.env.context.active_model;console.log(this.state);var n={width:"auto",float:"left","margin-right":"10px"},a={};return this.state.offline||(a.display="none"),l.a.createElement(V,{cache:e.cache,title:window.tools.view[t].string},l.a.createElement("div",{className:"card",style:{margin:0,boxShadow:"none"}},l.a.createElement("div",{className:"card-header"},l.a.createElement("div",{className:"data-table-title"},window.tools.view[t].string,l.a.createElement("span",{style:{color:"#666666"}}," / "+(this.state.active_id&&this.state.active_id.id?this.state.active_id.name:"New")),l.a.createElement("div",null,l.a.createElement(p.Button,{onClick:this.edit.bind(this),style:n,fill:!0},this.state.editing?"Save":"Edit"),l.a.createElement(p.Button,{onClick:function(){return P.globals.app.router.back()},style:Object(o.a)({},n,this.state.editing?{}:{display:"none"})},"Cancel"),l.a.createElement(p.Button,{onClick:this.upload.bind(this),style:Object(o.a)({},n,a),fill:!0},"Upload")))),e.children))}}]),t}(l.a.Component),ae=function(e){return l.a.createElement("div",{style:{margin:0,backgroundColor:"#8F8F8F",minHeight:"56px"}},e.children)};function re(){return(re=Object(i.a)(r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=P.preload(),!t.name){e.next=11;break}return e.prev=2,e.next=5,window.models.env.context.active_id[t.name]();case 5:e.next=11;break;case 7:e.prev=7,e.t0=e.catch(2),console.log(e.t0),n.done();case 11:return e.next=13,window.models.env.context.refresh();case 13:n.done();case 14:case"end":return e.stop()}},e,this,[[2,7]])}))).apply(this,arguments)}var ie=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(f.a)(this,Object(h.a)(t).call(this,e))).state=window.models.env.context,n}return Object(w.a)(t,e),Object(v.a)(t,[{key:"render",value:function(e){var t=this;return l.a.createElement(p.Button,{fill:!0,onClick:function(){return function(e){return re.apply(this,arguments)}.bind(t)(e)},style:{display:"block",float:"left",width:"auto",margin:"10px"}},e.string)}}]),t}(l.a.Component),oe=function(e){function t(){return Object(m.a)(this,t),Object(f.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(w.a)(t,e),Object(v.a)(t,[{key:"render",value:function(e){return l.a.createElement("div",{className:"card",style:{minHeight:"250px",marginTop:"20px"}},l.a.createElement("div",{className:"card-content form-sheet"},e.children))}}]),t}(l.a.Component),se=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(f.a)(this,Object(h.a)(t).call(this,e))).state.lastHeight=0,n}return Object(w.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(e){var t=this;if(!this.haveChild||null!==this.refs.group.previousElementSibling)var n=setInterval(function(){if(!t.refs.group||!t.refs.group.previousElementSibling)return clearInterval(n);var e=t.refs.group.previousElementSibling.clientHeight-20;e!==t.state.lastHeight&&t.setState({lastHeight:e})},500)}},{key:"render",value:function(e){return this.haveChild=void 0!==e.children,e.width&&"%"===e.width.slice(-1)&&parseInt(e.width.slice(0,-1))>97&&(e.width="97%"),l.a.createElement("div",{ref:"group",className:"component-group",style:{float:"left",width:e.width||"46.5%",padding:"10px",marginTop:"20px",height:e.children?"auto":this.state.lastHeight+"px"}},e.children)}}]),t}(l.a.Component),le=function(e){function t(){return Object(m.a)(this,t),Object(f.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(w.a)(t,e),Object(v.a)(t,[{key:"render",value:function(e){return l.a.createElement("div",{className:"card",style:{margin:0,boxShadow:"none",padding:"20px",minHeight:"30%",marginTop:"30px"}},l.a.createElement("div",{className:"card-header"},e.children))}}]),t}(l.a.Component);window.rapydComponents=Object(o.a)({},window.rapydComponents,{Form:ne,Header:ae,Button:ie,Sheet:oe,Group:se,Field:Y,Tree:X,Footer:le});var ce={},ue=function(e){function t(){return Object(m.a)(this,t),Object(f.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(w.a)(t,e),Object(v.a)(t,[{key:"render",value:function(e){var t=this;this.refresh=function(){return t.setState({})}.bind(this),window.models.env.context.refresh=this.refresh;var n=window.models.env.context.active_model;e.f7route?(n=e.f7route.params.model,window.models.env.context.active_url=e.f7route.url):window.models.env.context.active_url="/";var a=e.f7route.query.id,r=window.tools.view[n].form;return window.models.env.context.active_model=n,a?window.models.env.context.active_ids=[a]:delete window.models.env.context.active_ids,ce[r]||(ce[r]=function(e,t){var n=Object(o.a)({},window.rapydComponents,{Form:ne,Header:ae,Button:ie,Sheet:oe,Group:se,Field:Y,Tree:X,Footer:le});return function e(a,r){var i=[],o=!0,s=!1,c=void 0;try{for(var u,d=a[Symbol.iterator]();!(o=(u=d.next()).done);o=!0){var p=u.value,m=P.hasValue(p.tagName,"-")?n[p.tagName.split("-").map(function(e){return e[0].toUpperCase()+e.slice(1).toLowerCase()}).join("")]:n[p.tagName[0].toUpperCase()+p.tagName.toLowerCase().slice(1)]||n[p.tagName]||p.tagName,v={model:t},f=!0,h=!1,w=void 0;try{for(var b,g=p.attributes[Symbol.iterator]();!(f=(b=g.next()).done);f=!0){var x=b.value;v[x.name]=x.value}}catch(y){h=!0,w=y}finally{try{f||null==g.return||g.return()}finally{if(h)throw w}}m===X&&(v.model=window.models.env[t]._fields[r.name].relation,v.field=window.models.env[t]._fields[r.name].inverse),i.push(l.a.createElement(m,v,e(p.children,v)))}}catch(y){s=!0,c=y}finally{try{o||null==d.return||d.return()}finally{if(s)throw c}}return i=1===i.length?i[0]:i}([e=(new DOMParser).parseFromString(e,"text/xml").children[0]])}(r,n)),ce[r]}}]),t}(l.a.Component),de=function(e){if(void 0===window.models)return l.a.createElement(F,null);if(window.tools.configuration.home_view){var t=window.tools.configuration.home_view.split(".").slice(-1)[0],n=window.tools.configuration.home_view.split(".").slice(0,-1).join(".");if(window.models.env.context.active_model=n,"tree"===t)return l.a.createElement(ee,null);if("form"===t)return l.a.createElement(ue,null)}return l.a.createElement(p.Page,null,l.a.createElement(p.Navbar,null,l.a.createElement(p.NavLeft,null,l.a.createElement(p.Link,{iconMd:"material:menu",panelOpen:"left"})),l.a.createElement(p.NavTitle,null,"Home"),l.a.createElement(p.NavRight,null,l.a.createElement(p.Link,{iconMd:"material:person",panelOpen:"right"}))),l.a.createElement(p.Toolbar,null,l.a.createElement(p.Link,null,"Left Link"),l.a.createElement(p.Link,null,"Right Link")),l.a.createElement(p.Block,{strong:!0},l.a.createElement("p",null,"Here is your blank Framework7 app. Let's see what we have here.")),l.a.createElement(p.BlockTitle,null,"Navigation"),l.a.createElement(p.List,null,l.a.createElement(p.ListItem,{link:"/about/",title:"About"}),l.a.createElement(p.ListItem,{link:"/form/",title:"Form"})),l.a.createElement(p.BlockTitle,null,"Modals"),l.a.createElement(p.Block,{strong:!0},l.a.createElement(p.Row,null,l.a.createElement(p.Col,{width:"50"},l.a.createElement(p.Button,{fill:!0,raised:!0,popupOpen:"#popup"},"Popup")),l.a.createElement(p.Col,{width:"50"},l.a.createElement(p.Button,{fill:!0,raised:!0,loginScreenOpen:"#login-screen"},"Login Screen")))),l.a.createElement(p.BlockTitle,null,"Panels"),l.a.createElement(p.Block,{strong:!0},l.a.createElement(p.Row,null,l.a.createElement(p.Col,{width:"50"},l.a.createElement(p.Button,{fill:!0,raised:!0,panelOpen:"left"},"Left Panel")),l.a.createElement(p.Col,{width:"50"},l.a.createElement(p.Button,{fill:!0,raised:!0,panelOpen:"right"},"Right Panel")))),l.a.createElement(p.List,null,l.a.createElement(p.ListItem,{link:"/dynamic-route/blog/45/post/125/?foo=bar#about",title:"Dynamic Route"}),l.a.createElement(p.ListItem,{link:"/load-something-that-doesnt-exist/",title:"Default Route (404)"})))},pe=function(){return l.a.createElement(p.Page,null,l.a.createElement(p.Navbar,{title:"About",backLink:"Back"}),l.a.createElement(p.BlockTitle,null,"About My App"),l.a.createElement(p.Block,{strong:!0},l.a.createElement("p",null,"Here is About page!"),l.a.createElement("p",null,"You can go ",l.a.createElement(p.Link,{back:!0},"back"),"."),l.a.createElement("p",null,"Mauris posuere sit amet metus id venenatis. Ut ante dolor, tempor nec commodo rutrum, varius at sem. Nullam ac nisi non neque ornare pretium. Nulla mauris mauris, consequat et elementum sit amet, egestas sed orci. In hac habitasse platea dictumst."),l.a.createElement("p",null,"Fusce eros lectus, accumsan eget mi vel, iaculis tincidunt felis. Nulla tincidunt pharetra sagittis. Fusce in felis eros. Nulla sit amet aliquam lorem, et gravida ipsum. Mauris consectetur nisl non sollicitudin tristique. Praesent vitae metus ac quam rhoncus mattis vel et nisi. Aenean aliquet, felis quis dignissim iaculis, lectus quam tincidunt ligula, et venenatis turpis risus sed lorem. Morbi eu metus elit. Ut vel diam dolor.")))};window.rapydComponents=Object(o.a)({},window.rapydComponents,{Form:ne,Header:ae,Button:ie,Sheet:oe,Group:se,Field:Y,Tree:X,Footer:le});var me={},ve=function(e){var t,n=window.models.env.context.active_model;if(e.f7route){var a=e.f7route.params.view_id.split(".");n=a.slice(0,-1).join("."),t=a[a.length-1],window.models.env.context.active_url=e.f7route.url}else window.models.env.context.active_url="/";var r=window.tools.view[n][t];return window.models.env.context.active_model=n,me[r]||(me[r]=function(e,t){var n=Object(o.a)({},window.rapydComponents,{Form:ne,Header:ae,Button:ie,Sheet:oe,Group:se,Field:Y,Tree:X,Footer:le});return function e(a,r){var i=[],o=!0,s=!1,c=void 0;try{for(var u,d=a[Symbol.iterator]();!(o=(u=d.next()).done);o=!0){var p=u.value,m=P.hasValue(p.tagName,"-")?n[p.tagName.split("-").map(function(e){return e[0].toUpperCase()+e.slice(1).toLowerCase()}).join("")]:n[p.tagName[0].toUpperCase()+p.tagName.toLowerCase().slice(1)]||n[p.tagName]||p.tagName,v={model:t},f=!0,h=!1,w=void 0;try{for(var b,g=p.attributes[Symbol.iterator]();!(f=(b=g.next()).done);f=!0){var x=b.value;v[x.name]=x.value}}catch(y){h=!0,w=y}finally{try{f||null==g.return||g.return()}finally{if(h)throw w}}m===X&&(v.model=window.models.env[t]._fields[r.name].relation,v.field=window.models.env[t]._fields[r.name].inverse),i.push(l.a.createElement(m,v,e(p.children,v)))}}catch(y){s=!0,c=y}finally{try{o||null==d.return||d.return()}finally{if(s)throw c}}return i=1===i.length?i[0]:i}([e=(new DOMParser).parseFromString(e,"text/xml").children[0]])}(r,n)),me[r]},fe=function(){return l.a.createElement(p.Page,null,l.a.createElement(p.Navbar,{title:"Not found",backLink:"Back"}),l.a.createElement(p.Block,{strong:!0},l.a.createElement("p",null,"Sorry"),l.a.createElement("p",null,"Requested content not found.")))},he=!1;function we(){P.globals.app.params.panel.leftBreakpoint=he?768:1e6,P.globals.app.panel.left.initBreakpoints(),he=!he}var be=function(){return l.a.createElement(p.Page,null,l.a.createElement(p.Navbar,{title:"Menu"}),l.a.createElement("div",{id:"menu",className:"list list-block media-list chevron-center inset",style:{fontWeight:500},panelClose:!0},window.tools.keys(window.tools.menu,"sequence").as_array().map(function(e,t){return l.a.createElement("ul",null,l.a.createElement("li",{className:"accordion-item"},l.a.createElement("a",{className:"item-link item-content"+(window.tools.menu[e].childs.length<1?" panel-close external":""),onClick:window.tools.menu[e].childs.length<1&&function(e){return e.preventDefault()||P.globals.app.panel.left.close()==={}||P.globals.app.views.main.router.navigate(e.currentTarget.href.split("#!")[1])},href:window.tools.menu[e].childs.length<1&&"#!/"+(window.tools.menu[e].view_id?"view":"tree")+"/"+(window.tools.menu[e].view_id||window.tools.menu[e].model),"data-view":"#main-view"},l.a.createElement("div",{className:"item-inner"},l.a.createElement("div",{className:"item-title"},window.tools.menu[e].string))),window.tools.menu[e].childs.as_array().map(function(e,t){return l.a.createElement("div",{className:"accordion-item-content"},l.a.createElement("a",{className:"item-content panel-close external",onClick:function(e){return e.preventDefault()||P.globals.app.panel.left.close()==={}||P.globals.app.views.main.router.navigate(e.currentTarget.href.split("#!")[1])},href:"#!/"+(e.view_id?"view":"tree")+"/"+(e.view_id||e.model),"data-view":"#main-view"},l.a.createElement("div",{className:"item-inner"},l.a.createElement("div",{className:"item-title"},e.string))))})))})),l.a.createElement(p.Link,{iconMd:"material:more_horiz",iconSize:"30",onClick:we,style:{display:"inline-block",margin:"10px"}}))},ge=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(f.a)(this,Object(h.a)(t).call(this,e))).render=function(e){return l.a.createElement(p.Page,null,l.a.createElement(p.Navbar,null,l.a.createElement(p.NavLeft,{className:"user-link"},l.a.createElement(p.List,null,l.a.createElement(p.ListItem,{link:"#",title:n.state.name},l.a.createElement(p.Icon,{material:"person"}))))),l.a.createElement(p.Toolbar,{tabbar:!0},l.a.createElement(p.Link,{tabLink:"#notification",tabLinkActive:!0},"Notifications")),l.a.createElement(p.Tabs,null,l.a.createElement(p.Tab,{id:"notification",className:"page-content",tabActive:!0,style:{paddingTop:"0px"}},l.a.createElement(p.List,{mediaList:!0,style:{marginTop:"0px"}},l.a.createElement(p.ListItem,{link:"#",title:"Notification Title",after:"17:20",text:"Notification Text"})),l.a.createElement(p.Button,{fill:!0,onClick:P.logout,style:{display:"inline-block",margin:"10px"}},"Logout"))))},n.state={name:""},n}return Object(w.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){var e=Object(i.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return P.globals.app=this.$f7,window.c=P,e.t0=this,e.next=5,window.models.env.user.browse(window.models.env.user.id.toString()).then(function(e){return e.name});case 5:e.t1=e.sent,e.t2={name:e.t1},e.t0.setState.call(e.t0,e.t2);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),t}(l.a.Component),xe=function(){return window.models?[{path:"/",component:de},{path:"/panel-left/",component:be},{path:"/panel-right/",component:ge},{path:"/about/",component:pe},{path:"/tree/:model",component:ee},{path:"/form/:model",component:ue},{path:"/view/:view_id",component:ve},{path:"(.*)",component:fe}]:[{path:"(.*)",component:de}]},ye=function(e){var t={id:"org.rapyd.client",name:"App",theme:"md",routes:xe(),panel:{leftBreakpoint:960}};return l.a.createElement(p.App,{params:t,colorTheme:window.tools&&window.tools.configuration.color_theme?window.tools&&window.tools.configuration.color_theme:"gray"},l.a.createElement(p.Statusbar,null),void 0!==window.models&&l.a.createElement(p.Panel,{left:!0,reveal:!0},l.a.createElement(p.View,{url:"/panel-left/"})),void 0!==window.models&&l.a.createElement(p.Panel,{right:!0,cover:!0},l.a.createElement(p.View,{url:"/panel-right/"})),l.a.createElement(p.View,{id:"main-view",url:"/",main:!0,className:"ios-edges",pushState:!0}),l.a.createElement(p.Popup,{id:"popup"},l.a.createElement(p.View,null,l.a.createElement(p.Page,null,l.a.createElement(p.Navbar,{title:"Popup"},l.a.createElement(p.NavRight,null,l.a.createElement(p.Link,{popupClose:!0},"Close"))),l.a.createElement(p.Block,null,"Lorem ipsum dolor sit amet, consectetur adipisicing elit. Neque, architecto. Cupiditate laudantium rem nesciunt numquam, ipsam. Voluptates omnis, a inventore atque ratione aliquam. Omnis iusto nemo quos ullam obcaecati, quod.")))),l.a.createElement(p.LoginScreen,{id:"login-screen"},l.a.createElement(p.View,null,l.a.createElement(p.Page,{loginScreen:!0},l.a.createElement(p.LoginScreenTitle,null,"Login"),l.a.createElement(p.List,{form:!0},l.a.createElement(p.ListItem,null,l.a.createElement(p.Label,null,"Username"),l.a.createElement(p.Input,{name:"username",placeholder:"Username",type:"text"})),l.a.createElement(p.ListItem,null,l.a.createElement(p.Label,null,"Password"),l.a.createElement(p.Input,{name:"password",type:"password",placeholder:"Password"}))),l.a.createElement(p.List,null,l.a.createElement(p.ListButton,{title:"Sign In",loginScreenClose:!0}),l.a.createElement(p.BlockFooter,null,l.a.createElement("p",null,"Click Sign In to close Login Screen")))))))};n(303),n(305),n(307);n(198).install(),d.a.use(p.default),window.React=l.a,window.ReactDOM=u.a,window.rapydComponents=Object(o.a)({},p,window.rapydComponents,{Page:V,Flatpickr:z}),Object(i.a)(r.a.mark(function e(){var t,n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.get_session();case 2:return e.next=4,u.a.render(l.a.createElement(ye),document.getElementById("app"));case 4:window.tools&&window.tools.configuration.custom_navbar&&((t=document.createElement("style")).innerHTML=".navbar, .toolbar {background-color: "+window.tools.configuration.custom_navbar+"!important}",document.querySelector("head").append(t)),document.querySelector("div.navbar")&&((n=document.createElement("meta")).name="theme-color",n.content="#"+getComputedStyle(document.querySelector(".navbar"),null).backgroundColor.replace("rgb(","").replace(")","").split(", ").map(function(e){return parseInt(e).toString(16)}).map(function(e){return 1===e.length?"0"+e:e}).join(""),document.querySelector("head").appendChild(n));case 6:case"end":return e.stop()}},e,this)}))()},77:function(e,t){if(!window.ReactDOM)throw Error("ReactDOM must be defined on global variable");e.exports=window.ReactDOM}},[[201,2,1]]]);
//# sourceMappingURL=main.ca7cb123.chunk.js.map